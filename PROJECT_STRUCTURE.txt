Memoiz Project Snapshot
=======================

Root
----
- `README.md`
- `AGENTS.md`
- `LICENSE`
- `build.gradle.kts`, `settings.gradle.kts`, `gradle.properties`
- `gradlew`, `gradlew.bat`, `gradle/`
- `app/`

`app/`
-----
- `build.gradle.kts`
- `proguard-rules.pro`
- `src/main/`
  - `AndroidManifest.xml`
  - `java/com/machi/memoiz/`
    - `MemoizApplication.kt`, `MainActivity.kt`
    - `boot/` (startup hooks)
    - `data/` (Room entities, DAOs, repositories, database)
    - `domain/` (`Memo`, `MemoGroup`, DTOs)
    - `processtext/` and `share/` entry activities
    - `service/` (`AiCategorizationService`, `MlKitCategorizer`, `CategoryMergeService`, helpers) — contains model management, download logic, and image-analysis fallback logic (image description → prompt fallback). Batch re-analysis flows have been removed from default background workers; per-memo retries remain.
    - `importexport/` (helpers and background workers for data import/export) — provides encrypted ZIP export/import using `zip4j` and validates archives before applying imports. The Settings UI triggers export/import flows and displays progress and friendly error messages.
    - `worker/` (`ClipboardProcessingWorker` etc.)
    - `ui/`
      - `screens/` (`MainScreen`, `SettingsScreen`), view models — `SettingsScreen` now displays AI feature status (Enabled/Disabled/Downloading/Error)
      - `dialog/` (`CatStatusDialogActivity.kt`) — UI for "メモイズから一言" / Memoiz status dialog showing character image and parameters; selects `_last` variants when thresholds/EXP conditions are met and displays `_last` slightly larger.
      - `theme/` (Material 3 theme tokens)
      - `ViewModelFactory.kt`
    - `util/` (`UsageStatsHelper`, `ImageUriManager`, formatters)
      - `MemoizStatusHelper.kt` — central helper to compute memoiz status labels (e.g. `kindness_last`) used by UI and startup analytics; includes DEBUG-friendly thresholds used for tests.
  - `res/`
    - `values/` + `values-ja/` (strings, themes)
    - `drawable*/`, `mipmap*/`, `xml/` (backup/data extraction rules)

Tests
-----
- Unit tests: `app/src/test/java/com/machi/memoiz/util/MemoizStatusHelperTest.kt` (covers debug/release thresholds and boundary cases for status label computation)

Build Output Highlights
-----------------------
- `app/build/outputs/apk/` → APK artifacts
- `app/build/outputs/` (baseline profiles, metadata)
- `app/build/exports/` (user export archives may be staged here during debug runs) — exports are ZIP archives (optionally password-protected).

Auxiliary
---------
- `genai_sample/` (sample ML Kit reference)
- `.github/` (CI workflows)
